---
{"dg-publish":true,"permalink":"/🎓研究生/七院/VR数据处理/","dgPassFrontmatter":true}
---


# 数据集格式
- 多个被试信息
	- 多次测试数据
		- 一系列location坐标

# 一、需求
1. 计算耗时（P1-P2-P3-P1'）
2. 计算在P3的滞留时间（第一次离开以P3为圆心，半径为两倍头部半径的圆）
3. 计算在路径上的速度
4. 画路径热力图

# 二、采用的方法
## 1、如何定义到达某一点？
- location坐标在以点坐标为圆心，半径为20cm的圆内
## 2、如何让定义在某一点停留？
- location坐标在以点坐标为圆心，半径为30cm的圆内
## 3、P1'的取值
-  location中最后一个坐标点
## 3、数据质量较差的标记
- 使用value值进行标记：
	- 1：数据质量好
	- 0：从P3前往P1'的路径过短（小于window_length）
	- -10：未到达过P3点
	- -5：先到达P3后到达P1
	- -100：当前测试无 location坐标

## 4、速度的计算
1. 计算当前点坐标与上一点的位移/时间间隔
2. 发现直接差分计算容易放大噪声
3. 原始数据保持不变，画图时对速度进行重采样/滤波平滑

# 三、最终输出
- 以每个人为单位创建文件夹，包含：
	- figs子文件夹：内含每次测试的ABC图
	- result.xlsx
		- name：姓名
		- time：测试时间
		- Missangel
		- Missvalue
		- duration：耗时（P1-P2-P3-P1'）
		- P3_stay：在P3的滞留时间
		- value：数据质量标记
		- P1_arrive：第一次到P1的采样点序号
		- P2_arrive：第一次到P2的采样点序号
		- P3_arrive：第一次到P3的采样点序号
		- P1_leave：最后一次离开P1的采样点序号
		- P2_leave：最后一次离开P2的采样点序号
		- P3_leave：最后一次离开P3的采样点序号
	- D图

# 四、可调节的参数
- data_path  # 原始文件保存的目录
- on_point = 0.2  # 与点的距离小于0.2则判定为在点上
- around_point = 0.3  # 与点的距离小于0.3则判定为在点附近
- show = 0  # 是1否0展示图片
- v_show = 0  # 是1否0显示速度
- show_D = 0  # 是1否0展示D图
- save = 1  # 是1否0保存图片
- smooth = 1  # 是1否0对速度进行平滑
- window_length = 31  # 窗口长度，该值需为正奇整数
- k = 5  # 对窗口内的数据点进行k阶多项式拟合，k的值需要小于window_length
- down_sample = 1  # 降采样倍数，1则不进行降采样
- pic_dpi = 200  # 图片dpi
